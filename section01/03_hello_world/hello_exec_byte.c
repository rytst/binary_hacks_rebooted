// Hello, World! by byte sequence of hello_for_elfhack
#include <string.h>
#include <sys/mman.h>

// byte sequence of hello_for_elfhack
unsigned char hello_for_elfhack[] = {
  0xe8, 0x0e, 0x00, 0x00, 0x00, 0x48, 0x65, 0x6c, 0x6c, 0x6f, 0x2c, 0x20,
  0x57, 0x6f, 0x72, 0x6c, 0x64, 0x21, 0x0a, 0xba, 0x0e, 0x00, 0x00, 0x00,
  0x5e, 0xbf, 0x01, 0x00, 0x00, 0x00, 0xb8, 0x01, 0x00, 0x00, 0x00, 0x0f,
  0x05, 0xbf, 0x00, 0x00, 0x00, 0x00, 0xb8, 0x3c, 0x00, 0x00, 0x00, 0x0f,
  0x05
};
unsigned int hello_for_elfhack_len = 49;


int main(void)
{
    void *code = mmap(NULL, 4096, PROT_READ | PROT_WRITE | PROT_EXEC, MAP_PRIVATE | MAP_ANONYMOUS, -1, 0);

    // copy hello_for_elfhack_len characters from hello_for_elfhack to code
    memcpy(code, hello_for_elfhack, hello_for_elfhack_len);
    void (*fn)(void) = (void (*)(void))code; // function pointer
    fn();
}
